## SNS 웹사이트 요구사항 정의서

아래 요구사항은 **인스타그램 유사 SNS 웹사이트**를 대상으로 하며, 현재 설계된 엔티티(`User`, `Post`, `Comment`, `Like`, `Follow`, `Story`, `StoryView`, `Hashtag`, `PostHashtag`, `PostTag`, `Block`, `Report`, `ChatRoom`, `DirectMessage`, `Notification`, `ScrappedPost`, `SavedCollection`, `SavedPost` 등)를 기반으로 도출한 기능/비기능 요구사항입니다.

---

## 1. 사용자 관리

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 1 | REQ-USER-001 | 사용자 회원가입 | 사용자는 `username`, `email`, `password` 등의 정보를 입력하여 회원가입을 할 수 있어야 한다. 회원 정보는 `User` 엔티티에 저장되며 `username`과 `email`은 유일해야 한다. |
| 2 | REQ-USER-002 | 사용자 로그인 | 사용자는 가입한 `email` 또는 `username`과 `password`를 사용하여 로그인할 수 있어야 한다. 로그인 성공 시 세션/토큰 기반으로 인증 상태를 유지한다. |
| 3 | REQ-USER-003 | 프로필 정보 조회 | 사용자는 자신의 프로필 정보(`name`, `bio`, `profileImageUrl`, 게시물 수, 팔로워/팔로잉 수 등)를 조회할 수 있어야 한다. 기본 정보는 `User`, 집계 정보는 관련 테이블에서 계산한다. |
| 4 | REQ-USER-004 | 프로필 정보 수정 | 사용자는 `name`, `bio`, `profileImageUrl` 등의 프로필 정보를 수정할 수 있어야 한다. 수정 이력은 `updatedAt`에 반영된다. |
| 5 | REQ-USER-005 | 비공개 계정 설정 | 사용자는 계정을 공개/비공개로 전환할 수 있어야 하며, 해당 정보는 `User.isPrivate`에 저장되어 접근 제어에 활용된다. |
| 6 | REQ-USER-006 | 사용자 검색 | 사용자는 `username` 또는 `name`으로 다른 사용자를 검색할 수 있어야 한다. 검색 결과는 `User` 엔티티를 기준으로 제공된다. |

---

## 2. 게시물 관리

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 7 | REQ-POST-001 | 게시물 작성 | 사용자는 텍스트(`caption`), 이미지, 동영상을 포함한 게시물을 작성할 수 있어야 한다. 게시물 메타 정보는 `Post`, 이미지/영상 URL은 `post_image`, `post_video` 테이블에 저장된다. |
| 8 | REQ-POST-002 | 게시물 위치 정보 저장 | 사용자는 게시물 작성 시 위치 정보를 입력할 수 있으며, 값은 `Post.location`에 저장된다. |
| 9 | REQ-POST-003 | 게시물 수정 | 사용자는 자신이 작성한 게시물의 텍스트와 위치 정보를 수정할 수 있어야 하고, 수정 시점은 `Post.updatedAt`에 기록된다. |
| 10 | REQ-POST-004 | 게시물 삭제 | 사용자는 자신이 작성한 게시물을 삭제할 수 있어야 한다. 삭제 시 관련 댓글, 좋아요, 태그, 해시태그 관계, 스크랩/저장 정보 등 연관 데이터도 함께 정리되어야 한다. |
| 11 | REQ-POST-005 | 게시물 상세 조회 | 사용자는 특정 게시물의 내용, 작성자, 작성 시간, 위치, 이미지/영상, 댓글, 좋아요 수 등 상세 정보를 조회할 수 있어야 한다. 정보는 `Post` 및 연관 엔티티를 조합하여 제공된다. |
| 12 | REQ-POST-006 | 사용자 태그 기능 | 사용자는 게시물에 다른 사용자를 태그할 수 있어야 한다. 태그 정보는 `PostTag` 엔티티에 저장되며, 태그된 사용자의 위치(x, y)를 함께 기록할 수 있다. |

---

## 3. 댓글 및 대댓글 관리

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 13 | REQ-COMMENT-001 | 댓글 작성 | 사용자는 게시물에 댓글을 작성할 수 있어야 한다. 댓글 정보는 `Comment` 엔티티에 저장되며 `postId`, `userId`, `content` 등을 포함한다. |
| 14 | REQ-COMMENT-002 | 대댓글(답글) 작성 | 사용자는 기존 댓글에 대한 답글(대댓글)을 작성할 수 있어야 한다. 대댓글은 `Comment.parentCommentId`를 통해 부모 댓글을 참조한다. |
| 15 | REQ-COMMENT-003 | 댓글 수정 | 사용자는 자신이 작성한 댓글 내용을 수정할 수 있어야 하며, 수정 시간은 `Comment.updatedAt`에 기록된다. |
| 16 | REQ-COMMENT-004 | 댓글 삭제 | 사용자는 자신이 작성한 댓글을 삭제할 수 있어야 한다. 삭제 시 연관된 좋아요 및 신고 정보도 함께 정리되어야 한다. |
| 17 | REQ-COMMENT-005 | 댓글 목록 조회 | 사용자는 특정 게시물의 댓글 목록을 최신순 또는 특정 기준으로 조회할 수 있어야 한다. 데이터는 `Comment` 엔티티에서 조회한다. |

---

## 4. 좋아요 기능

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 18 | REQ-LIKE-001 | 게시물 좋아요 | 사용자는 게시물에 좋아요를 누를 수 있어야 하며, 정보는 `Like` 엔티티에 `postId`와 함께 저장된다. 한 사용자는 같은 게시물에 한 번만 좋아요를 누를 수 있다. |
| 19 | REQ-LIKE-002 | 댓글 좋아요 | 사용자는 댓글에 좋아요를 누를 수 있어야 하며, 정보는 `Like` 엔티티에 `commentId`와 함께 저장된다. 한 사용자는 같은 댓글에 한 번만 좋아요를 누를 수 있다. |
| 20 | REQ-LIKE-003 | 좋아요 취소 | 사용자는 자신이 누른 좋아요를 취소할 수 있어야 하며, 해당 `Like` 레코드는 삭제된다. |
| 21 | REQ-LIKE-004 | 좋아요 수 조회 | 사용자는 게시물 및 댓글의 총 좋아요 수를 조회할 수 있어야 하며, 이는 `Like` 테이블을 집계하여 계산한다. |

---

## 5. 팔로우 및 소셜 관계

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 22 | REQ-FOLLOW-001 | 팔로우 | 사용자는 다른 사용자를 팔로우할 수 있어야 하며, 팔로우 관계는 `Follow` 엔티티에 `followerId`, `followingId`로 저장된다. |
| 23 | REQ-FOLLOW-002 | 언팔로우 | 사용자는 기존 팔로우 관계를 해제(언팔로우)할 수 있어야 하며, 해당 `Follow` 레코드는 삭제된다. |
| 24 | REQ-FOLLOW-003 | 팔로워/팔로잉 목록 조회 | 사용자는 자신의 팔로워 목록과 팔로잉 목록을 조회할 수 있어야 한다. 데이터는 `Follow` 테이블 기반으로 제공된다. |
| 25 | REQ-FOLLOW-004 | 비공개 계정 팔로우 승인 | 비공개 계정(`isPrivate = TRUE`) 사용자의 경우, 팔로우 요청을 승인/거절하는 프로세스를 지원해야 하며, 추후 필요 시 상태 컬럼을 `Follow` 또는 별도 엔티티로 확장할 수 있어야 한다. |

---

## 6. 스토리 및 조회 기록

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 26 | REQ-STORY-001 | 스토리 작성 | 사용자는 24시간 동안만 유지되는 스토리를 작성할 수 있어야 한다. 스토리 데이터는 `Story` 엔티티에 저장되며, 이미지/영상/텍스트와 `expiresAt`을 포함한다. |
| 27 | REQ-STORY-002 | 스토리 자동 만료 | 시스템은 `Story.expiresAt` 이후의 스토리를 피드/조회 결과에서 자동으로 제외하거나 별도 배치 작업으로 정리해야 한다. |
| 28 | REQ-STORY-003 | 스토리 조회 기록 저장 | 사용자가 스토리를 조회할 때마다 `StoryView` 엔티티에 `userId`, `storyId`, `viewedAt`이 기록되어야 한다. 한 사용자-스토리 쌍은 한 번만 기록된다. |
| 29 | REQ-STORY-004 | 스토리 조회자 목록 | 스토리 작성자는 자신의 스토리를 조회한 사용자 목록을 확인할 수 있어야 하며, 데이터는 `StoryView`로부터 제공된다. |

---

## 7. 해시태그 및 분류

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 30 | REQ-HASHTAG-001 | 해시태그 등록 및 연동 | 사용자가 게시물에 해시태그를 입력하면, 해시태그 텍스트는 `Hashtag` 엔티티에 저장되고, 게시물-해시태그 관계는 `PostHashtag` 엔티티에 저장된다. |
| 31 | REQ-HASHTAG-002 | 해시태그로 게시물 검색 | 사용자는 특정 해시태그를 기준으로 관련 게시물 목록을 조회할 수 있어야 하며, `PostHashtag`를 통해 `Post` 목록을 가져온다. |
| 32 | REQ-HASHTAG-003 | 해시태그 자동완성 | 사용자가 해시태그를 입력할 때 기존 해시태그 목록(`Hashtag.tag`)을 기반으로 자동완성 기능을 제공할 수 있어야 한다. |

---

## 8. 스크랩 및 저장 컬렉션

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 33 | REQ-SCRAP-001 | 게시물 스크랩 | 사용자는 마음에 드는 게시물을 스크랩할 수 있어야 하며, 스크랩 정보는 `ScrappedPost` 엔티티에 저장된다. 한 사용자-게시물 쌍은 한 번만 스크랩 가능하다. |
| 34 | REQ-SCRAP-002 | 스크랩 취소 | 사용자는 스크랩한 게시물을 다시 취소할 수 있어야 하며, 해당 `ScrappedPost` 레코드는 삭제된다. |
| 35 | REQ-SAVE-001 | 저장 컬렉션 생성 | 사용자는 게시물을 분류하기 위한 저장 컬렉션을 생성할 수 있어야 한다. 컬렉션 정보는 `SavedCollection`에 저장되며, 이름과 설명, 커버 이미지 등을 포함한다. |
| 36 | REQ-SAVE-002 | 저장 컬렉션에 게시물 추가 | 사용자는 특정 저장 컬렉션에 게시물을 저장할 수 있어야 하며, 정보는 `SavedPost` 엔티티에 `userId`, `postId`, `collectionId`로 저장된다. |
| 37 | REQ-SAVE-003 | 저장 컬렉션 기본 컬렉션 | 사용자는 기본 컬렉션(예: “전체 저장”)을 가질 수 있으며, 기본 컬렉션 여부는 `SavedCollection.isDefault`로 관리된다. `SavedPost.collectionId`가 NULL인 경우 기본 컬렉션으로 간주할 수 있다. |
| 38 | REQ-SAVE-004 | 저장 컬렉션/저장 게시물 관리 | 사용자는 저장 컬렉션 목록과 각 컬렉션에 포함된 게시물 목록을 조회하고, 컬렉션 이름/설명을 수정하거나 삭제할 수 있어야 한다. |

---

## 9. 차단 및 신고 기능

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 39 | REQ-BLOCK-001 | 사용자 차단 | 사용자는 특정 사용자를 차단할 수 있어야 하며, 차단 정보는 `Block` 엔티티에 `blockerId`, `blockedId`로 저장된다. 차단된 사용자와는 상호 소통이 제한된다. |
| 40 | REQ-BLOCK-002 | 사용자 차단 해제 | 사용자는 기존에 차단한 사용자를 차단 해제할 수 있어야 하고, 해당 `Block` 레코드는 삭제된다. |
| 41 | REQ-REPORT-001 | 게시물/댓글/사용자 신고 | 사용자는 부적절한 게시물, 댓글, 사용자 계정을 신고할 수 있어야 하며, 신고 정보는 `Report` 엔티티에 신고 유형, 대상 정보, 사유와 함께 저장된다. |
| 42 | REQ-REPORT-002 | 신고 처리 상태 관리 | 운영자는 신고 건에 대해 처리 상태를 `PENDING`, `REVIEWING`, `RESOLVED`, `REJECTED`로 변경할 수 있어야 한다. 상태 정보는 `Report.status`와 `updatedAt`에 반영된다. |
| 43 | REQ-REPORT-003 | 신고 이력 조회 | 운영자 및 필요 권한을 가진 사용자는 특정 사용자 또는 콘텐츠에 대한 신고 이력을 조회할 수 있어야 한다. |

---

## 10. 다이렉트 메시지(DM) 및 채팅

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 44 | REQ-CHAT-001 | 채팅방 생성 | 사용자가 다른 사용자에게 DM을 처음 보낼 때, 1:1 채팅방이 `ChatRoom` 엔티티에 생성되어야 한다. 동일 사용자 쌍에 대해 중복 채팅방이 생성되지 않아야 한다. |
| 45 | REQ-CHAT-002 | 메시지 전송 | 사용자는 채팅방 내에서 텍스트 및 이미지가 포함된 메시지를 전송할 수 있어야 하고, 메시지는 `DirectMessage` 엔티티에 저장된다. |
| 46 | REQ-CHAT-003 | 읽음 상태 관리 | 수신자가 메시지를 읽었을 경우 `DirectMessage.isRead` 및 `readAt`이 갱신되어야 하며, 발신자는 읽음 여부를 확인할 수 있어야 한다. |
| 47 | REQ-CHAT-004 | 채팅 목록 및 최근 메시지 | 사용자는 자신이 속한 채팅방 목록과 각 채팅방의 최근 메시지, 마지막 메시지 시각(`ChatRoom.lastMessageAt`)을 조회할 수 있어야 한다. |

---

## 11. 알림 시스템

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 48 | REQ-NOTI-001 | 좋아요 알림 | 다른 사용자가 자신의 게시물 또는 댓글에 좋아요를 남겼을 때, 알림이 `Notification` 엔티티에 `type = LIKE`로 저장되어야 한다. |
| 49 | REQ-NOTI-002 | 댓글/멘션 알림 | 다른 사용자가 자신의 게시물에 댓글을 남기거나, 댓글/게시물에서 자신을 멘션했을 경우 `type = COMMENT` 또는 `type = MENTION` 알림이 생성되어야 한다. |
| 50 | REQ-NOTI-003 | 팔로우 알림 | 다른 사용자가 자신을 팔로우하면 `type = FOLLOW` 알림이 생성되어야 하며, 관련 `Follow` 레코드와 연동된다. |
| 51 | REQ-NOTI-004 | 태그/스토리 조회/메시지 알림 | 게시물에 태그되거나(`POST_TAG`), 스토리가 조회되거나(`STORY_VIEW`), DM 메시지를 수신한 경우(`MESSAGE`), 각 상황에 맞는 알림 레코드가 생성되어야 한다. |
| 52 | REQ-NOTI-005 | 알림 읽음 처리 | 사용자는 알림을 읽음 처리할 수 있어야 하며, `Notification.isRead`와 `readAt`이 갱신된다. |
| 53 | REQ-NOTI-006 | 알림 목록 조회 | 사용자는 자신의 알림 목록을 최신순으로 조회할 수 있어야 하고, 읽지 않은 알림을 우선적으로 표시할 수 있어야 한다. |

---

## 12. 비기능 요구사항 (데이터베이스/설계 관점)

| 요구사항 번호 | 요구사항 ID | 요구사항 명 | 요구사항 상세 설명 |
| --- | --- | --- | --- |
| 54 | NFR-DB-001 | 데이터 무결성 보장 | 모든 엔티티는 정규화(2NF, 3NF, BCNF)를 만족해야 하며, 파생 속성은 저장하지 않고 필요 시 조회 시점에 계산 또는 VIEW로 제공해야 한다. |
| 55 | NFR-DB-002 | 참조 무결성 유지 | 모든 관계는 적절한 `FOREIGN KEY` 제약조건을 통해 참조 무결성을 보장해야 하며, 삭제/갱신 시 `ON DELETE`/`ON UPDATE` 규칙을 명확히 정의해야 한다. |
| 56 | NFR-DB-003 | 중복 데이터 방지 | `username`, `email`, 팔로우/좋아요/스크랩/저장 관계 등 중복될 수 없는 조합에 대해 `UNIQUE` 제약조건을 설정하여 중복 데이터를 방지해야 한다. |
| 57 | NFR-DB-004 | 확장 가능한 스키마 | 새로운 기능 추가(예: 스토리 하이라이트, 그룹 채팅 등) 시 기존 스키마 변경을 최소화할 수 있도록 엔티티 간 느슨한 결합과 관계형 설계를 유지해야 한다. |
| 58 | NFR-DB-005 | 조회 성능 최적화 | 잦은 조회가 발생하는 컬럼(예: `userId`, `postId`, `createdAt`)에 인덱스를 적절히 생성하여 조회 성능을 최적화해야 한다. |
| 59 | NFR-DB-006 | 데이터 접근 제어 | 비공개 계정, 차단 관계 등 접근 제어 정책을 애플리케이션 레벨과 DB 설계에서 함께 고려하여, 권한이 없는 사용자가 민감한 데이터에 접근하지 못하도록 해야 한다. |

---

## 활용 안내

- 본 요구사항 정의서는 **ERD 설계, 기능 명세서, 테스트 케이스 설계**의 기준 문서로 사용할 수 있습니다.  
- 새로운 기능을 추가할 때는, 우선 해당 기능에 대한 **요구사항 ID와 표 형태의 정의를 추가**한 후, 이에 맞게 엔티티 및 DDL을 확장하는 방식으로 관리하는 것을 권장합니다.


